<!doctype html>
<!--suppress ALL -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="{{ url_for('static', filename='favicon.ico') }}" rel="icon" type="image/x-icon">
    <title>Model Answers - 4</title>
    <link href="{{ url_for('static', filename='css/model.answer.css') }}" rel="stylesheet">
</head>
<h3 id="model-answer-guide-for-challenge-4-reverse-engineering-with-wireshark">Model Answer Guide for Challenge 4: Reverse Engineering with Wireshark</h3>
<h4 id="challenge-description">Challenge Description</h4>
<p>In this challenge, participants are required to locate the
    PCAP file containing the hidden flag. The flag format is <code>KEY{xxxx}</code>.</p>
<h4 id="steps-to-solve-the-challenge">Steps to Solve the Challenge</h4>
<ol>
    <li><p><strong>Download the PCAP Files:</strong></p>
        <ul>
            <li>The PCAP files are provided for this challenge. Download all 100 files from the challenge page.</li>
        </ul>
    </li>
    <li><p><strong>Automate the Analysis:</strong></p>
        <ul>
            <li>Create a script to automate the analysis of each PCAP file to find the correct one containing the flag.</li>
        </ul>
    </li>
    <li><p><strong>Analyze Each PCAP File:</strong></p>
        <ul>
            <li>Use Wireshark or a Python script to analyze each PCAP file.</li>
            <li>Look for packets containing the flag format <code>KEY{xxxx}</code>.</li>
        </ul>
    </li>
    <li><p><strong>Extract the Flag:</strong></p>
        <ul>
            <li>The flag is embedded in one of the packets. Use Wireshark or a script to extract the flag.</li>
        </ul>
    </li>
    <li><p><strong>Verify the Flag:</strong></p>
        <ul>
            <li>After extracting the flag, verify it by submitting the file and the packet number to the challenge page.</li>
            <li>Ensure that the flag matches the required format and is correctly extracted from the packet.</li>
        </ul>
    </li>
</ol>
<h4 id="example-solution">Example Solution</h4>
<ol>
    <li><strong>Create a Script to Automate the Analysis:</strong><ul>
        <li>Write a Python script to automate the analysis of each PCAP file using the <code>pyshark</code> library.</li>
    </ul>
    </li>
</ol>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pyshark
<span class="hljs-keyword">import</span> os

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">analyze_pcap</span><span class="hljs-params">(file_path)</span>:</span>
    cap = pyshark.FileCapture(file_path)
    <span class="hljs-keyword">for</span> packet <span class="hljs-keyword">in</span> cap:
        <span class="hljs-keyword">if</span> <span class="hljs-string">'KEY{'</span> <span class="hljs-keyword">in</span> str(packet):
            <span class="hljs-keyword">return</span> packet
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
    pcap_dir = <span class="hljs-string">'path/to/pcap/files'</span>
    <span class="hljs-keyword">for</span> file_name <span class="hljs-keyword">in</span> os.listdir(pcap_dir):
        file_path = os.path.join(pcap_dir, file_name)
        flag_packet = analyze_pcap(file_path)
        <span class="hljs-keyword">if</span> flag_packet:
            print(f<span class="hljs-string">'Flag found in {file_name}: {flag_packet}'</span>)
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">else</span>:
        print(<span class="hljs-string">'Flag not found in any PCAP file.'</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    main()
</code></pre>
<ol>
    <li><p><strong>Run the Script:</strong></p>
        <ul>
            <li>Execute the script to analyze each PCAP file and find the one containing the flag.</li>
        </ul>
    </li>
    <li><p><strong>Extract the Flag:</strong></p>
        <ul>
            <li>Use Wireshark or the script to locate the packet containing the flag and extract it.</li>
            <li>Then get the packet number/line where the flag is, use <code>Ctrl+F</code> to find the flag of format <code>KEY{xxxx}</code>.</li>
        </ul>
    </li>
</ol>
<p>By following these steps, participants can successfully locate the
    correct PCAP file and extract the hidden flag for Challenge 3.</p>
</html>